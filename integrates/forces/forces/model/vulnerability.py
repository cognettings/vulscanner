from datetime import (
    datetime,
)
from decimal import (
    Decimal,
)
from enum import (
    StrEnum,
)
from typing import (
    NamedTuple,
)


class VulnerabilityState(StrEnum):
    """Data structure to represent the Vulnerability state status"""

    VULNERABLE: str = "vulnerable"
    SAFE: str = "safe"
    ACCEPTED: str = "accepted"


class VulnerabilityType(StrEnum):
    """Data structure to represent the Vulnerability type"""

    DAST: str = "DAST"
    SAST: str = "SAST"


class Vulnerability(NamedTuple):
    """Data structure to represent a Vulnerability"""

    type: VulnerabilityType
    where: str
    specific: str
    state: VulnerabilityState
    severity: Decimal
    report_date: datetime
    root_nickname: str | None
    exploitability: float
    compliance: bool
