import { gql } from "@apollo/client";
import type { DocumentNode } from "graphql";

import { VULNS_FRAGMENT } from "../../Finding-Content/VulnerabilitiesView/queries";

const GET_ME_VULNERABILITY_DRAFTS: DocumentNode = gql`
  query GetMeVulnerabilityDrafts(
    $after: String
    $findingTitle: String
    $first: Int
    $fromReportDate: DateTime
    $groupName: String
    $hacker: String
    $maxSeverityTemporalScore: Float
    $minSeverityTemporalScore: Float
    $organizationName: String
    $sourceType: VulnerabilitySourceType
    $stateStatus: String
    $toReportDate: DateTime
  ) {
    me(callerOrigin: "FRONT") {
      userEmail
      vulnerabilityDrafts(
        after: $after
        findingTitle: $findingTitle
        first: $first
        fromReportDate: $fromReportDate
        groupName: $groupName
        hacker: $hacker
        maxSeverityTemporalScore: $maxSeverityTemporalScore
        minSeverityTemporalScore: $minSeverityTemporalScore
        organizationName: $organizationName
        sourceType: $sourceType
        stateStatus: $stateStatus
        toReportDate: $toReportDate
      ) {
        edges {
          node {
            finding {
              id
              title
            }
            groupName
            ...vulnFields
            hacker
          }
        }
        pageInfo {
          endCursor
          hasNextPage
        }
        total
      }
      __typename
    }
  }
  ${VULNS_FRAGMENT}
`;

export { GET_ME_VULNERABILITY_DRAFTS };
