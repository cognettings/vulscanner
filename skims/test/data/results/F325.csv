title,cwe,description,cvss,finding,stream,kind,where,snippet,method
325. Excessive privileges - Wildcards,CWE-250,Amazon KMS master keys are exposed to everyone in namespace/skims/test/data/lib_root/f325/cfn_kms_key_has_master_keys_exposed_to_everyone.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,23,"
  13 |         Statement:
  14 |           - Sid: Enable IAM User Permissions
  15 |             Effect: Allow
  16 |             Principal:
  17 |               AWS: arn:aws:iam::111122223333:root
  18 |             Action: kms:*
  19 |             Resource: '*'
  20 |           - Sid: Enable IAM User Permissions
  21 |             Effect: Allow
  22 |             Principal:
> 23 |               AWS: '*'
  24 |             Action: kms:*
  25 |             Resource: '*'
  26 |   key2:
  27 |     Type: AWS::KMS::Key
  28 |     Properties:
  29 |       Description: An example multi-Region primary key
  30 |       MultiRegion: true
  31 |       EnableKeyRotation: false
  32 |       PendingWindowInDays: 10
  33 |       KeyPolicy:
     ^ Col 0
",cloudformation.cfn_kms_key_has_master_keys_exposed_to_everyone
325. Excessive privileges - Wildcards,CWE-250,Amazon KMS master keys are exposed to everyone in namespace/skims/test/data/lib_root/f325/cfn_kms_key_has_master_keys_exposed_to_everyone.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,27,"
  17 |               ""Principal"": {
  18 |                 ""AWS"": ""arn:aws:iam::111122223333:root""
  19 |               },
  20 |               ""Action"": ""kms:*"",
  21 |               ""Resource"": ""*""
  22 |             },
  23 |             {
  24 |               ""Sid"": ""Enable IAM User Permissions"",
  25 |               ""Effect"": ""Allow"",
  26 |               ""Principal"": {
> 27 |                 ""AWS"": ""*""
  28 |               },
  29 |               ""Action"": ""kms:*"",
  30 |               ""Resource"": ""*""
  31 |             }
  32 |           ]
  33 |         }
  34 |       }
  35 |     },
  36 |     ""key2"": {
  37 |       ""Type"": ""AWS::KMS::Key"",
     ^ Col 0
",cloudformation.cfn_kms_key_has_master_keys_exposed_to_everyone
325. Excessive privileges - Wildcards,CWE-250,Amazon KMS master keys are exposed to everyone in namespace/skims/test/data/lib_root/f325/tfm_kms_key_has_master_keys_exposed_to_everyone.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,5,"
   1 | resource ""aws_kms_key"" ""vuln_key_exposed_1"" {
   2 |   description             = ""KMS key 1""
   3 |   deletion_window_in_days = 10
   4 |
>  5 |   policy = <<-EOF
   6 |   {
   7 |     ""Version"": ""2012-10-17"",
   8 |     ""Statement"": [
   9 |       {
  10 |         ""Principal"": {
  11 |           ""AWS"": ""*""
  12 |         },
  13 |         ""Effect"": ""Allow""
  14 |       }
  15 |     ]
  16 |   }
  17 |   EOF
  18 | }
  19 |
  20 |
  21 | resource ""aws_kms_key"" ""sec_key"" {
     ^ Col 0
",terraform.tfm_kms_key_has_master_keys_exposed_to_everyone
325. Excessive privileges - Wildcards,CWE-250,Amazon KMS master keys are exposed to everyone,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,CSPM,/Statement/0/Principal/AWS: *,"
  1 | {
  2 |     ""Statement"": [
  3 |         {
  4 |             ""Principal"": {
> 5 |                 ""AWS"": ""*""
  6 |             }
  7 |         }
  8 |     ]
  9 | }
    ^ Col 0
",aws.kms_has_master_keys_exposed_to_everyone
325. Excessive privileges - Wildcards,CWE-250,"IAM Policy should consider the next rules: - Should not allow wildcard () action. - Should not apply directly to users, Should be on group. - Should not allow wildcard () resource with PassRole action. - Should not allow wildcard () resource. - Should not allow AllowNotAction. - Should not allow AllowNotResource.
",CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,CSPM,"IAM Policy should consider the next rules: - Should not allow wildcard () action. - Should not apply directly to users, Should be on group. - Should not allow wildcard () resource with PassRole action. - Should not allow wildcard () resource. - Should not allow AllowNotAction. - Should not allow AllowNotResource.
","
  1 | {
  2 |     ""Document"": ""{'Statement':[{'Effect': 'Allow', 'Action': '*', 'Resource': '*'},{'Effect': 'Allow', 'Resource': '*',
    | 'Action': '*',},{'Effect': 'Allow', 'NotAction': ['w',], 'NotResource': ['w',]} ],}"",
  3 |     ""VersionId"": ""v1"",
  4 |     ""IsDefaultVersion"": true
  5 | }
    ^ Col 0
",aws.iam_is_policy_miss_configured
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,53,"
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
  46 |                 Action: iam:*
  47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
> 53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,46,"
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
> 46 |                 Action: iam:*
  47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
  53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,69,"
  59 |         },
  60 |         ""Path"": ""/"",
  61 |         ""Policies"": [
  62 |           {
  63 |             ""PolicyName"": ""root"",
  64 |             ""PolicyDocument"": {
  65 |               ""Version"": ""2012-10-17"",
  66 |               ""Statement"": [
  67 |                 {
  68 |                   ""Effect"": ""Allow"",
> 69 |                   ""Action"": ""iam:*"",
  70 |                   ""Resource"": ""*""
  71 |                 }
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,82,"
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
  80 |                 {
  81 |                   ""Effect"": ""Allow"",
> 82 |                   ""Action"": ""*"",
  83 |                   ""Resource"": ""s3:GetObject""
  84 |                 }
  85 |               ]
  86 |             }
  87 |           }
  88 |         ]
  89 |       }
  90 |     }
  91 |   }
  92 | }
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,27,"
   17 |             Action: rds:CreateGlobalCluster
   18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
>  27 |             Action:
   28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,76,"
   66 |                 - ec2.amazonaws.com
   67 |             Action:
   68 |               - sts:AssumeRole
   69 |       Path: /
   70 |       Policies:
   71 |         - PolicyName: root
   72 |           PolicyDocument:
   73 |             Version: '2012-10-17'
   74 |             Statement:
   75 |               - Effect: Allow
>  76 |                 Action: '*'
   77 |                 Resource: '*'
   78 |         - PolicyName: root
   79 |           PolicyDocument:
   80 |             Version: '2012-10-17'
   81 |             Statement:
   82 |               - Effect: Deny
   83 |                 Action: '*'
   84 |                 Resource: '*'
   85 |         - PolicyName: root
   86 |           PolicyDocument:
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,104,"
   86 |           PolicyDocument:
   87 |             Version: '2012-10-17'
   88 |             Statement:
   89 |               - Effect: Allow
   90 |                 Action: ec2:ModifySnapshotAttribute
   91 |                 Resource: '*'
   92 |         - PolicyName: root
   93 |           PolicyDocument:
   94 |             Version: '2012-10-17'
   95 |             Statement:
   96 |               - Effect: Allow
   97 |                 Action: s3:List*
   98 |                 Resource: '*'
   99 |         - PolicyName: root
  100 |           PolicyDocument:
  101 |             Version: '2012-10-17'
  102 |             Statement:
  103 |               - Effect: Allow
> 104 |                 Action: '*'
  105 |                 Resource:
  106 |                   - ec2:StartInstances
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,37,"
   27 |                 ""*""
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
>  37 |               ""Action"": [
   38 |                 ""rds:*""
   39 |               ],
   40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
   44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,116,"
  106 |         },
  107 |         ""Path"": ""/"",
  108 |         ""Policies"": [
  109 |           {
  110 |             ""PolicyName"": ""root"",
  111 |             ""PolicyDocument"": {
  112 |               ""Version"": ""2012-10-17"",
  113 |               ""Statement"": [
  114 |                 {
  115 |                   ""Effect"": ""Allow"",
> 116 |                   ""Action"": ""*"",
  117 |                   ""Resource"": ""*""
  118 |                 }
  119 |               ]
  120 |             }
  121 |           },
  122 |           {
  123 |             ""PolicyName"": ""root"",
  124 |             ""PolicyDocument"": {
  125 |               ""Version"": ""2012-10-17"",
  126 |               ""Statement"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,168,"
  158 |               ]
  159 |             }
  160 |           },
  161 |           {
  162 |             ""PolicyName"": ""root"",
  163 |             ""PolicyDocument"": {
  164 |               ""Version"": ""2012-10-17"",
  165 |               ""Statement"": [
  166 |                 {
  167 |                   ""Effect"": ""Allow"",
> 168 |                   ""Action"": ""*"",
  169 |                   ""Resource"": [
  170 |                     ""ec2:StartInstances""
  171 |                   ]
  172 |                 }
  173 |               ]
  174 |             }
  175 |           }
  176 |         ]
  177 |       }
  178 |     }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,27,"
   17 |             Action: rds:CreateGlobalCluster
   18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
>  27 |             Action:
   28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,87,"
   77 |         - !Ref CFNUserGroup
   78 |   CreateTestDABPolicy:
   79 |     Type: AWS::IAM::ManagedPolicy
   80 |     Properties:
   81 |       Description: Policy for creating a test database
   82 |       Path: /
   83 |       PolicyDocument:
   84 |         Version: '2012-10-17'
   85 |         Statement:
   86 |           - Effect: Allow
>  87 |             Action: iam:*
   88 |             Condition:
   89 |               StringEquals:
   90 |                 rds:DatabaseEngine: mysql
   91 |           - Effect: Allow
   92 |             Action: rds:CreateGlobalCluster
   93 |             Resource:
   94 |               - ''
   95 |               - ec2:StartInstances
   96 |               - s3:GetObject
   97 |           - Effect: Allow
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,133,"
  123 |       Path: /
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
> 133 |                 Action: iam:*
  134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,140,"
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
  134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
> 140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
  144 |             Version: '2012-10-17'
  145 |             Statement:
  146 |               - Effect: Allow
  147 |                 NotAction: '*'
  148 |                 NotResource: s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,37,"
   27 |                 ""*""
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
>  37 |               ""Action"": [
   38 |                 ""rds:*""
   39 |               ],
   40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
   44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,131,"
  121 |     ""CreateTestDABPolicy"": {
  122 |       ""Type"": ""AWS::IAM::ManagedPolicy"",
  123 |       ""Properties"": {
  124 |         ""Description"": ""Policy for creating a test database"",
  125 |         ""Path"": ""/"",
  126 |         ""PolicyDocument"": {
  127 |           ""Version"": ""2012-10-17"",
  128 |           ""Statement"": [
  129 |             {
  130 |               ""Effect"": ""Allow"",
> 131 |               ""Action"": ""iam:*"",
  132 |               ""Condition"": {
  133 |                 ""StringEquals"": {
  134 |                   ""rds:DatabaseEngine"": ""mysql""
  135 |                 }
  136 |               }
  137 |             },
  138 |             {
  139 |               ""Effect"": ""Allow"",
  140 |               ""Action"": ""rds:CreateGlobalCluster"",
  141 |               ""Resource"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,207,"
  197 |             ""PolicyDocument"": {
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
  203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
> 207 |                   ""Action"": ""iam:*"",
  208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,220,"
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
  218 |                 {
  219 |                   ""Effect"": ""Allow"",
> 220 |                   ""Action"": ""*"",
  221 |                   ""Resource"": ""s3:GetObject""
  222 |                 }
  223 |               ]
  224 |             }
  225 |           },
  226 |           {
  227 |             ""PolicyName"": ""root1"",
  228 |             ""PolicyDocument"": {
  229 |               ""Version"": ""2012-10-17"",
  230 |               ""Statement"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,22,"
  12 |                 - ec2.amazonaws.com
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
> 22 |                 Action: iam:*
  23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
  29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,29,"
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
  22 |                 Action: iam:*
  23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
> 29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
  33 |         - arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,31,"
  21 |         },
  22 |         ""Path"": ""/"",
  23 |         ""Policies"": [
  24 |           {
  25 |             ""PolicyName"": ""root"",
  26 |             ""PolicyDocument"": {
  27 |               ""Version"": ""2012-10-17"",
  28 |               ""Statement"": [
  29 |                 {
  30 |                   ""Effect"": ""Allow"",
> 31 |                   ""Action"": ""iam:*"",
  32 |                   ""Resource"": ""*""
  33 |                 }
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its permissions policy in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,44,"
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
  42 |                 {
  43 |                   ""Effect"": ""Allow"",
> 44 |                   ""Action"": ""*"",
  45 |                   ""Resource"": ""s3:GetObject""
  46 |                 }
  47 |               ]
  48 |             }
  49 |           }
  50 |         ],
  51 |         ""ManagedPolicyArns"": [
  52 |           ""arn:aws:iam::aws:policy/AdministratorAccess"",
  53 |           ""arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess""
  54 |         ]
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its trust policy in namespace/skims/test/data/lib_root/f325/tfm_iam_wildcard_trust_policies.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,4,"
   1 | resource ""aws_iam_role"" ""vuln_role_1"" {
   2 |   name = ""safe_role_1""
   3 |
>  4 |   assume_role_policy = <<-EOF
   5 |   {
   6 |     ""Version"": ""2012-10-17"",
   7 |     ""Statement"": [
   8 |       {
   9 |         ""Resource"": ""*"",
  10 |         ""Action"": ""*"",
  11 |         ""Effect"": ""Allow""
  12 |       }
  13 |     ]
  14 |   }
  15 |   EOF
  16 | }
  17 |
  18 | resource ""aws_iam_role"" ""vuln_role_2"" {
  19 |   name = ""vuln_role_1""
  20 |
  21 |   assume_role_policy = jsonencode({
     ^ Col 0
",terraform.tfm_iam_trust_policy_allow_wildcard_action
325. Excessive privileges - Wildcards,CWE-250,IAM Role should not allow wildcard () action on its trust policy in namespace/skims/test/data/lib_root/f325/tfm_iam_wildcard_trust_policies.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,24,"
  14 |   }
  15 |   EOF
  16 | }
  17 |
  18 | resource ""aws_iam_role"" ""vuln_role_2"" {
  19 |   name = ""vuln_role_1""
  20 |
  21 |   assume_role_policy = jsonencode({
  22 |     Version = ""2012-10-17""
  23 |     Statement = [
> 24 |       {
  25 |         Effect = ""Allow""
  26 |         Action = [
  27 |           ""*""
  28 |         ],
  29 |         Resource = ""*""
  30 |       },
  31 |     ]
  32 |   })
  33 | }
  34 |
     ^ Col 0
",terraform.tfm_iam_trust_policy_allow_wildcard_action
325. Excessive privileges - Wildcards,CWE-250,Policies have privileges over IAM,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,CSPM,Policies have privileges over IAM,"
  1 | {
  2 |     ""Document"": ""{'Statement':[{'Effect': 'Allow', 'Action': '*', 'Resource': '*'},{'Effect': 'Allow', 'Resource': '*',
    | 'Action': '*',},{'Effect': 'Allow', 'NotAction': ['w',], 'NotResource': ['w',]} ],}"",
  3 |     ""VersionId"": ""v1"",
  4 |     ""IsDefaultVersion"": true
  5 | }
    ^ Col 0
",aws.iam_has_privileges_over_iam
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,47,"
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
  46 |                 Action: iam:*
> 47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
  53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,70,"
  60 |         ""Path"": ""/"",
  61 |         ""Policies"": [
  62 |           {
  63 |             ""PolicyName"": ""root"",
  64 |             ""PolicyDocument"": {
  65 |               ""Version"": ""2012-10-17"",
  66 |               ""Statement"": [
  67 |                 {
  68 |                   ""Effect"": ""Allow"",
  69 |                   ""Action"": ""iam:*"",
> 70 |                   ""Resource"": ""*""
  71 |                 }
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
  80 |                 {
     ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,77,"
   67 |             Action:
   68 |               - sts:AssumeRole
   69 |       Path: /
   70 |       Policies:
   71 |         - PolicyName: root
   72 |           PolicyDocument:
   73 |             Version: '2012-10-17'
   74 |             Statement:
   75 |               - Effect: Allow
   76 |                 Action: '*'
>  77 |                 Resource: '*'
   78 |         - PolicyName: root
   79 |           PolicyDocument:
   80 |             Version: '2012-10-17'
   81 |             Statement:
   82 |               - Effect: Deny
   83 |                 Action: '*'
   84 |                 Resource: '*'
   85 |         - PolicyName: root
   86 |           PolicyDocument:
   87 |             Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,117,"
  107 |         ""Path"": ""/"",
  108 |         ""Policies"": [
  109 |           {
  110 |             ""PolicyName"": ""root"",
  111 |             ""PolicyDocument"": {
  112 |               ""Version"": ""2012-10-17"",
  113 |               ""Statement"": [
  114 |                 {
  115 |                   ""Effect"": ""Allow"",
  116 |                   ""Action"": ""*"",
> 117 |                   ""Resource"": ""*""
  118 |                 }
  119 |               ]
  120 |             }
  121 |           },
  122 |           {
  123 |             ""PolicyName"": ""root"",
  124 |             ""PolicyDocument"": {
  125 |               ""Version"": ""2012-10-17"",
  126 |               ""Statement"": [
  127 |                 {
      ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,134,"
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
> 134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
  144 |             Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,208,"
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
  203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
  207 |                   ""Action"": ""iam:*"",
> 208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
  218 |                 {
      ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,23,"
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
  22 |                 Action: iam:*
> 23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
  29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
  33 |         - arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
     ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,32,"
  22 |         ""Path"": ""/"",
  23 |         ""Policies"": [
  24 |           {
  25 |             ""PolicyName"": ""root"",
  26 |             ""PolicyDocument"": {
  27 |               ""Version"": ""2012-10-17"",
  28 |               ""Statement"": [
  29 |                 {
  30 |                   ""Effect"": ""Allow"",
  31 |                   ""Action"": ""iam:*"",
> 32 |                   ""Resource"": ""*""
  33 |                 }
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
  42 |                 {
     ^ Col 0
",cloudformation.cfn_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/tfm_wildcard_privileges_passrole.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,51,"
  41 |     ]
  42 |   }
  43 | }
  44 |
  45 | resource ""aws_iam_role_policy"" ""vuln_role_1"" {
  46 |   name = ""vuln_role_1""
  47 |
  48 |   policy = jsonencode({
  49 |     Version = ""2012-10-17""
  50 |     Statement = [
> 51 |       {
  52 |         Action = [
  53 |           ""ec2:*"",
  54 |           ""s3:DeleteObjectVersion"",
  55 |           ""iam:*""
  56 |         ],
  57 |         Effect   = ""Allow""
  58 |         Resource = ""*""
  59 |       },
  60 |     ]
  61 |   })
     ^ Col 0
",terraform.terraform_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,53,"
   43 |     effect = ""Allow""
   44 |     actions = [
   45 |       ""codecommit:Update*""
   46 |     ]
   47 |
   48 |     resources = [
   49 |       ""*""
   50 |     ]
   51 |   }
   52 |
>  53 |   statement {
   54 |     effect    = ""Allow""
   55 |     actions   = [""*""]
   56 |     resources = [""*""]
   57 |   }
   58 | }
   59 |
   60 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
   61 |   name = ""vuln_role_policy_1""
   62 |   role = aws_iam_role.vuln_role_1
   63 |
      ^ Col 0
",terraform.terraform_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,84,"
   74 |       }
   75 |     ]
   76 |   }
   77 |   EOF
   78 | }
   79 |
   80 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
   81 |   name = ""vuln_role_policy_1""
   82 |   role = aws_iam_role.vuln_role_1
   83 |
>  84 |   policy = <<-EOF
   85 |   {
   86 |     ""Version"": ""2012-10-17"",
   87 |     ""Statement"": [
   88 |       {
   89 |         ""Effect"": ""Allow"",
   90 |         ""Action"": [
   91 |           ""*""
   92 |         ],
   93 |         ""Resource"": ""*""
   94 |       }
      ^ Col 0
",terraform.terraform_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,Should not allow wildcard () resource in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,106,"
   96 |   }
   97 |   EOF
   98 | }
   99 |
  100 | resource ""aws_iam_role_policy"" ""vuln_role_1"" {
  101 |   name = ""vuln_role_1""
  102 |
  103 |   policy = jsonencode({
  104 |     Version = ""2012-10-17""
  105 |     Statement = [
> 106 |       {
  107 |         Action = [
  108 |           ""codecommit:Update*"",
  109 |           ""s3:DeleteObjectVersion"",
  110 |           ""eks:*"",
  111 |           ""*""
  112 |         ],
  113 |         Effect    = ""Allow""
  114 |         Principal = ""*""
  115 |         Resource  = ""*""
  116 |       },
      ^ Col 0
",terraform.terraform_permissive_policy
325. Excessive privileges - Wildcards,CWE-250,"The wildcard () is used to give access to any user, including anonymous users in namespace/skims/test/data/lib_path/f325/excessive_priv.config",CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,11,"
   1 | <?xml version=""1.0"" encoding=""UTF-8""?>
   2 | <configuration>
   3 |     <system.webServer>
   4 |         <security>
   5 |             <authentication>
   6 |                 <anonymousAuthentication enabled=""true"" userName="""" />
   7 |                 <basicAuthentication enabled=""false"" />
   8 |             </authentication>
   9 |
  10 |             <authorization>
> 11 |                 <add accessType=""Allow"" users=""*"" />
  12 |                 <add accessType=""Deny"" users=""*"" />
  13 |                 <add accessType=""Allow"" users=""admin"" />
  14 |             </authorization>
  15 |
  16 |         </security>
  17 |     </system.webServer>
  18 | </configuration>
     ^ Col 0
",dotnetconfig.dotnetconfig_excessive_auth_privileges
325. Excessive privileges - Wildcards,CWE-250,"The wildcard () is used to give access to any user, including anonymous users in namespace/skims/test/data/lib_root/f325/json_principal_wildcard.json",CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,8,"
   1 | {
   2 |   ""Statement"": [
   3 |     {
   4 |       ""Action"": [
   5 |         ""s3:GetObject""
   6 |       ],
   7 |       ""Effect"": ""Allow"",
>  8 |       ""Principal"": ""*"",
   9 |       ""Resource"": [
  10 |         ""arn:aws:s3:::bgx-digital-onboarding-frontend/*""
  11 |       ],
  12 |       ""Sid"": ""AddPerm""
  13 |     }
  14 |   ],
  15 |   ""Version"": ""2012-10-17""
  16 | }
     ^ Col 0
",conf_files.json_principal_wildcard
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,47,"
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
  46 |                 Action: iam:*
> 47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
  53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_privileges_over_iam.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,70,"
  60 |         ""Path"": ""/"",
  61 |         ""Policies"": [
  62 |           {
  63 |             ""PolicyName"": ""root"",
  64 |             ""PolicyDocument"": {
  65 |               ""Version"": ""2012-10-17"",
  66 |               ""Statement"": [
  67 |                 {
  68 |                   ""Effect"": ""Allow"",
  69 |                   ""Action"": ""iam:*"",
> 70 |                   ""Resource"": ""*""
  71 |                 }
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
  80 |                 {
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,18,"
    8 |       PolicyDocument:
    9 |         Version: '2012-10-17'
   10 |         Statement:
   11 |           - Effect: Allow
   12 |             Action: rds:CreateDBInstance
   13 |             Condition:
   14 |               StringEquals:
   15 |                 rds:DatabaseEngine: mysql
   16 |           - Effect: Allow
   17 |             Action: rds:CreateGlobalCluster
>  18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,29,"
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
>  29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,40,"
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
>  40 |             Resource:
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
   44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,51,"
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
   44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
>  51 |             Resource: '*'
   52 |             Condition:
   53 |               StringEquals:
   54 |                 rds:DatabaseClass: db.t2.micro
   55 |       Groups:
   56 |         - TestDBGroup
   57 |   RootRole:
   58 |     Type: AWS::IAM::Role
   59 |     Properties:
   60 |       AssumeRolePolicyDocument:
   61 |         Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,23,"
   13 |               ""Action"": ""rds:CreateDBInstance"",
   14 |               ""Condition"": {
   15 |                 ""StringEquals"": {
   16 |                   ""rds:DatabaseEngine"": ""mysql""
   17 |                 }
   18 |               }
   19 |             },
   20 |             {
   21 |               ""Effect"": ""Allow"",
   22 |               ""Action"": ""rds:CreateGlobalCluster"",
>  23 |               ""Resource"": [
   24 |                 """",
   25 |                 ""ec2:StartInstances"",
   26 |                 ""s3:GetObject"",
   27 |                 ""*""
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,40,"
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
   38 |                 ""rds:*""
   39 |               ],
>  40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
   44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   49 |                 }
   50 |               }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,57,"
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   49 |                 }
   50 |               }
   51 |             },
   52 |             {
   53 |               ""Effect"": ""Allow"",
   54 |               ""Action"": [
   55 |                 ""rds:ModifyDBCluster*""
   56 |               ],
>  57 |               ""Resource"": [
   58 |                 """",
   59 |                 ""ec2:StartInstances"",
   60 |                 ""s3:GetObject"",
   61 |                 ""*""
   62 |               ],
   63 |               ""Condition"": {
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,74,"
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
   68 |             },
   69 |             {
   70 |               ""Effect"": ""Allow"",
   71 |               ""Action"": [
   72 |                 ""rds:CreateDBSnapshot""
   73 |               ],
>  74 |               ""Resource"": ""*"",
   75 |               ""Condition"": {
   76 |                 ""StringEquals"": {
   77 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   78 |                 }
   79 |               }
   80 |             }
   81 |           ]
   82 |         },
   83 |         ""Groups"": [
   84 |           ""TestDBGroup""
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,18,"
    8 |       PolicyDocument:
    9 |         Version: '2012-10-17'
   10 |         Statement:
   11 |           - Effect: Allow
   12 |             Action: rds:CreateDBInstance
   13 |             Condition:
   14 |               StringEquals:
   15 |                 rds:DatabaseEngine: mysql
   16 |           - Effect: Allow
   17 |             Action: rds:CreateGlobalCluster
>  18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,29,"
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
>  29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,40,"
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
>  40 |             Resource:
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
   44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,51,"
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
   44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
>  51 |             Resource: '*'
   52 |             NotResource:
   53 |               - arn:aws:s3:::HRBucket/Payroll
   54 |               - arn:aws:s3:::HRBucket/Payroll/*
   55 |             Condition:
   56 |               StringEquals:
   57 |                 rds:DatabaseClass: db.t2.micro
   58 |       Users:
   59 |         - user1
   60 |       Groups:
   61 |         - TestDBGroup
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,105,"
   95 |               - ec2:StartInstances
   96 |               - s3:GetObject
   97 |           - Effect: Allow
   98 |             Action: ecs:DescribeServices
   99 |             Resource: '*'
  100 |             Condition:
  101 |               StringEquals:
  102 |                 rds:DatabaseClass: db.t2.micro
  103 |           - Effect: Allow
  104 |             Action: ecs:CreateService
> 105 |             Resource: '*'
  106 |             Condition:
  107 |               StringEquals:
  108 |                 rds:DatabaseClass: db.t2.micro
  109 |       Groups:
  110 |         - TestDBGroup
  111 |   RootRole:
  112 |     Type: AWS::IAM::Role
  113 |     Properties:
  114 |       AssumeRolePolicyDocument:
  115 |         Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,131,"
  121 |             NotAction:
  122 |               - sts:AssumeRole
  123 |       Path: /
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
> 131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
  134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,134,"
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
> 134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
  144 |             Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,23,"
   13 |               ""Action"": ""rds:CreateDBInstance"",
   14 |               ""Condition"": {
   15 |                 ""StringEquals"": {
   16 |                   ""rds:DatabaseEngine"": ""mysql""
   17 |                 }
   18 |               }
   19 |             },
   20 |             {
   21 |               ""Effect"": ""Allow"",
   22 |               ""Action"": ""rds:CreateGlobalCluster"",
>  23 |               ""Resource"": [
   24 |                 """",
   25 |                 ""ec2:StartInstances"",
   26 |                 ""s3:GetObject"",
   27 |                 ""*""
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,40,"
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
   38 |                 ""rds:*""
   39 |               ],
>  40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
   44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   49 |                 }
   50 |               }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,57,"
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   49 |                 }
   50 |               }
   51 |             },
   52 |             {
   53 |               ""Effect"": ""Allow"",
   54 |               ""Action"": [
   55 |                 ""rds:ModifyDBCluster*""
   56 |               ],
>  57 |               ""Resource"": [
   58 |                 """",
   59 |                 ""ec2:StartInstances"",
   60 |                 ""s3:GetObject"",
   61 |                 ""*""
   62 |               ],
   63 |               ""Condition"": {
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,74,"
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
   68 |             },
   69 |             {
   70 |               ""Effect"": ""Allow"",
   71 |               ""Action"": [
   72 |                 ""rds:CreateDBSnapshot""
   73 |               ],
>  74 |               ""Resource"": ""*"",
   75 |               ""NotResource"": [
   76 |                 ""arn:aws:s3:::HRBucket/Payroll"",
   77 |                 ""arn:aws:s3:::HRBucket/Payroll/*""
   78 |               ],
   79 |               ""Condition"": {
   80 |                 ""StringEquals"": {
   81 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   82 |                 }
   83 |               }
   84 |             }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,160,"
  150 |               ""Resource"": ""*"",
  151 |               ""Condition"": {
  152 |                 ""StringEquals"": {
  153 |                   ""rds:DatabaseClass"": ""db.t2.micro""
  154 |                 }
  155 |               }
  156 |             },
  157 |             {
  158 |               ""Effect"": ""Allow"",
  159 |               ""Action"": ""ecs:CreateService"",
> 160 |               ""Resource"": ""*"",
  161 |               ""Condition"": {
  162 |                 ""StringEquals"": {
  163 |                   ""rds:DatabaseClass"": ""db.t2.micro""
  164 |                 }
  165 |               }
  166 |             }
  167 |           ]
  168 |         },
  169 |         ""Groups"": [
  170 |           ""TestDBGroup""
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,203,"
  193 |         ""Path"": ""/"",
  194 |         ""Policies"": [
  195 |           {
  196 |             ""PolicyName"": ""root"",
  197 |             ""PolicyDocument"": {
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
> 203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
  207 |                   ""Action"": ""iam:*"",
  208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_policy_miss_configured.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,208,"
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
  203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
  207 |                   ""Action"": ""iam:*"",
> 208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
  218 |                 {
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,23,"
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
  22 |                 Action: iam:*
> 23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
  29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
  33 |         - arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/cfn_iam_is_role_over_privileged.yaml.json,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,32,"
  22 |         ""Path"": ""/"",
  23 |         ""Policies"": [
  24 |           {
  25 |             ""PolicyName"": ""root"",
  26 |             ""PolicyDocument"": {
  27 |               ""Version"": ""2012-10-17"",
  28 |               ""Statement"": [
  29 |                 {
  30 |                   ""Effect"": ""Allow"",
  31 |                   ""Action"": ""iam:*"",
> 32 |                   ""Resource"": ""*""
  33 |                 }
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
  42 |                 {
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_privileges_passrole.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,5,"
   1 | resource ""aws_iam_role_policy"" ""test_policy"" {
   2 |   name = ""test_policy""
   3 |   role = aws_iam_role.test_role.id
   4 |
>  5 |   policy = <<-EOF
   6 |   {
   7 |     ""Statement"": [
   8 |       {
   9 |         ""Effect"": ""Allow"",
  10 |         ""Action"": ""iam:PassRole"",
  11 |         ""Resource"": ""*"",
  12 |         ""Condition"": {
  13 |           ""StringEquals"": {
  14 |             ""iam:PassedToService"": ""cloudwatch.amazonaws.com""
  15 |           }
  16 |         }
  17 |       },
  18 |       {
  19 |         ""Effect"": ""Allow"",
  20 |         ""Action"": ""iam:PassRole"",
  21 |         ""Resource"": ""arn:aws:iam::*:role/EC2-roles-for-XYZ-*""
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_privileges_passrole.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,34,"
  24 |         ""Effect"": ""Allow"",
  25 |         ""Action"": ""iam:Pass*"",
  26 |         ""Resource"": ""*""
  27 |       }
  28 |     ]
  29 |   }
  30 |   EOF
  31 | }
  32 |
  33 | data ""aws_iam_policy_document"" ""example"" {
> 34 |   statement {
  35 |     actions = [
  36 |       ""iam:PassRole""
  37 |     ]
  38 |
  39 |     resources = [
  40 |       ""*"",
  41 |     ]
  42 |   }
  43 | }
  44 |
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_privileges_passrole.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,51,"
  41 |     ]
  42 |   }
  43 | }
  44 |
  45 | resource ""aws_iam_role_policy"" ""vuln_role_1"" {
  46 |   name = ""vuln_role_1""
  47 |
  48 |   policy = jsonencode({
  49 |     Version = ""2012-10-17""
  50 |     Statement = [
> 51 |       {
  52 |         Action = [
  53 |           ""ec2:*"",
  54 |           ""s3:DeleteObjectVersion"",
  55 |           ""iam:*""
  56 |         ],
  57 |         Effect   = ""Allow""
  58 |         Resource = ""*""
  59 |       },
  60 |     ]
  61 |   })
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,30,"
   20 |     ]
   21 |
   22 |     resources = [
   23 |       ""arn:aws:codebuild::111111111111:project/test"",
   24 |       ""arn:aws:codecommit::111111111111:test""
   25 |     ]
   26 |   }
   27 | }
   28 |
   29 | data ""aws_iam_policy_document"" ""vuln_policy_1"" {
>  30 |   statement {
   31 |     effect = ""Allow""
   32 |     actions = [
   33 |       ""a4b:ApproveSkill"",
   34 |       ""codecommit:CreateBranch""
   35 |     ]
   36 |
   37 |     resources = [
   38 |       ""*""
   39 |     ]
   40 |   }
      ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,42,"
   32 |     actions = [
   33 |       ""a4b:ApproveSkill"",
   34 |       ""codecommit:CreateBranch""
   35 |     ]
   36 |
   37 |     resources = [
   38 |       ""*""
   39 |     ]
   40 |   }
   41 |
>  42 |   statement {
   43 |     effect = ""Allow""
   44 |     actions = [
   45 |       ""codecommit:Update*""
   46 |     ]
   47 |
   48 |     resources = [
   49 |       ""*""
   50 |     ]
   51 |   }
   52 |
      ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,53,"
   43 |     effect = ""Allow""
   44 |     actions = [
   45 |       ""codecommit:Update*""
   46 |     ]
   47 |
   48 |     resources = [
   49 |       ""*""
   50 |     ]
   51 |   }
   52 |
>  53 |   statement {
   54 |     effect    = ""Allow""
   55 |     actions   = [""*""]
   56 |     resources = [""*""]
   57 |   }
   58 | }
   59 |
   60 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
   61 |   name = ""vuln_role_policy_1""
   62 |   role = aws_iam_role.vuln_role_1
   63 |
      ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,64,"
   54 |     effect    = ""Allow""
   55 |     actions   = [""*""]
   56 |     resources = [""*""]
   57 |   }
   58 | }
   59 |
   60 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
   61 |   name = ""vuln_role_policy_1""
   62 |   role = aws_iam_role.vuln_role_1
   63 |
>  64 |   policy = <<-EOF
   65 |   {
   66 |     ""Version"": ""2012-10-17"",
   67 |     ""Statement"": [
   68 |       {
   69 |         ""Effect"": ""Allow"",
   70 |         ""Action"": [
   71 |           ""codecommit:CreateBranch""
   72 |         ],
   73 |         ""Resource"": ""*""
   74 |       }
      ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,84,"
   74 |       }
   75 |     ]
   76 |   }
   77 |   EOF
   78 | }
   79 |
   80 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
   81 |   name = ""vuln_role_policy_1""
   82 |   role = aws_iam_role.vuln_role_1
   83 |
>  84 |   policy = <<-EOF
   85 |   {
   86 |     ""Version"": ""2012-10-17"",
   87 |     ""Statement"": [
   88 |       {
   89 |         ""Effect"": ""Allow"",
   90 |         ""Action"": [
   91 |           ""*""
   92 |         ],
   93 |         ""Resource"": ""*""
   94 |       }
      ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources in namespace/skims/test/data/lib_root/f325/tfm_wildcard_resource_privileges.tf,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,SAST,106,"
   96 |   }
   97 |   EOF
   98 | }
   99 |
  100 | resource ""aws_iam_role_policy"" ""vuln_role_1"" {
  101 |   name = ""vuln_role_1""
  102 |
  103 |   policy = jsonencode({
  104 |     Version = ""2012-10-17""
  105 |     Statement = [
> 106 |       {
  107 |         Action = [
  108 |           ""codecommit:Update*"",
  109 |           ""s3:DeleteObjectVersion"",
  110 |           ""eks:*"",
  111 |           ""*""
  112 |         ],
  113 |         Effect    = ""Allow""
  114 |         Principal = ""*""
  115 |         Resource  = ""*""
  116 |       },
      ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
325. Excessive privileges - Wildcards,CWE-250,Write actions are allowed on all resources,CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L/E:U/RL:U/RC:C,https://docs.fluidattacks.com/criteria/vulnerabilities/325,skims,CSPM,Write actions are allowed on all resources,"
   1 | [
   2 |     {
   3 |         ""Effect"": ""Allow"",
   4 |         ""Action"": ""*"",
   5 |         ""Resource"": ""*""
   6 |     },
   7 |     {
   8 |         ""Effect"": ""Allow"",
   9 |         ""Resource"": ""*"",
  10 |         ""Action"": ""*""
  11 |     },
  12 |     {
  13 |         ""Effect"": ""Allow"",
  14 |         ""NotAction"": [
  15 |             ""w""
  16 |         ],
  17 |         ""NotResource"": [
  18 |             ""w""
  19 |         ]
  20 |     }
  21 | ]
     ^ Col 0
",aws.iam_has_wildcard_resource_on_write_action
Summary: 80 vulnerabilities were found in your targets.